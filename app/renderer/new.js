module.exports=webpackJsonp([4],{10:function(e,t){e.exports=require("fs")},15:function(e,t){e.exports=require("querystring")},16:function(e,t){e.exports=require("util")},2114:function(e,t,n){"use strict";var a=n(0),i=a(n(29)),r=a(n(2115));(0,i.default)(r.default,{name:"new"})},2115:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(896),i=n.n(a);for(var r in a)"default"!==r&&function(e){n.d(t,e,function(){return a[e]})}(r);var o=n(2122),s=n(1);var l=function(e){n(2116)},c=Object(s.a)(i.a,o.a,o.b,!1,l,"data-v-d4f1a544",null);t.default=c.exports},2116:function(e,t,n){var a=n(2117);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n(20).default)("141d6da0",a,!0,{})},2117:function(e,t,n){(e.exports=n(18)()).push([e.i,"\n.uk-window-expanded-title-bar[data-v-d4f1a544] {\n  z-index: auto;\n}\n.main-content-tab[data-v-d4f1a544] {\n  height: 42px;\n}\n.theme-category-dropdown[data-v-d4f1a544] {\n  right: 30px;\n  top: 2px;\n}\n.theme-category-dropdown > .uk-button-popover-toggle[data-v-d4f1a544] {\n  width: 100px;\n}\n",""])},2118:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(897),i=n.n(a);for(var r in a)"default"!==r&&function(e){n.d(t,e,function(){return a[e]})}(r);var o=n(2121),s=n(1);var l=function(e){n(2119)},c=Object(s.a)(i.a,o.a,o.b,!1,l,"data-v-b6b4e09a",null);t.default=c.exports},2119:function(e,t,n){var a=n(2120);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n(20).default)("06dcafcc",a,!0,{})},2120:function(e,t,n){(e.exports=n(18)()).push([e.i,"\nform[data-v-b6b4e09a] {\n  padding-top: 20px;\n  overflow-y: overlay;\n  overflow-x: hidden;\n}\n[uk-grid][data-v-b6b4e09a] {\n  margin-left: 30px;\n  margin-right: 30px;\n}\n[uk-grid] > li[data-v-b6b4e09a],\n[uk-grid] > li.uk-grid-margin[data-v-b6b4e09a] {\n  padding-left: 29px;\n  margin-top: 8px;\n  margin-bottom: 8px;\n}\n[uk-grid] > li.uk-first-column[data-v-b6b4e09a] {\n  padding-left: 0;\n}\n[uk-grid] > li.theme-category-name[data-v-b6b4e09a] {\n  color: rgba(0, 0, 0, 0.7);\n}\n",""])},2121:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"uk-panel uk-height-expand uk-overflow-auto",on:{submit:function(t){return t.preventDefault(),e.handleSubmitTheme(t)}}},[n("ul",{ref:"containerElement",attrs:{"uk-grid":"","uk-list-select":"","uk-traverse":"","data-traverse-mode":"nearest-item","data-item":".uk-card.uk-card-selectable","data-form":"true"}},[e._l(e.previews,function(t){return[e.isShowLabel?n("li",{key:t.label,staticClass:"uk-first-column uk-width-1-1 theme-category-name uk-margin-remove"},[n("h1",{staticClass:"uk-margin-top"},[e._v("\n          "+e._s(t.label)+"\n        ")])]):e._e(),e._v(" "),e._l(t.items,function(t,a){return n("li",{key:t.id,staticClass:"uk-grid-margin",class:{"uk-first-column":a%4==0}},[n("div",{staticClass:"uk-flex uk-flex-column uk-flex-middle"},[n("div",{staticClass:"uk-card uk-card-default uk-card-fix-sized uk-card-selectable uk-background-cover uk-border-rounded preview-card",attrs:{tabindex:"0","uk-img":"","data-src":t.previewURL},on:{listselectitem:function(n){return e.handleSelectTheme(t.id)},contextmenu:function(n){return e.$emit("contextmenu",t)}}}),e._v(" "),n("div",{staticClass:"uk-margin-small-top uk-text-center uk-card-selectable-text"},[e._v("\n            "+e._s(t.name)+"\n          ")])])])})]}),e._v(" "),e._t("footer")],2)])},i=[]},2122:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"uk-window uk-window-dialog uk-window-default"},[n("div",{staticClass:"uk-window-expanded-title-bar"},[n("div",{staticClass:"uk-window-title-bar"},[n("window-control-button-group")],1),e._v(" "),n("div",{staticClass:"uk-flex uk-flex-center uk-position-relative main-content-tab"},[n("ul",{staticClass:"uk-tab uk-tab-large uk-flex-center uk-tab-capsule",attrs:{"uk-tab":"connect: .main-content-switcher","data-active":e.activeTabIndex}},[e.availableTabs.includes("new")?n("li",[n("a",{attrs:{draggable:"false",href:"#"},on:{click:function(t){e.activeTab="new"}}},[e._v(e._s(e.$T("New")))])]):e._e(),e._v(" "),e.availableTabs.includes("library")?n("li",[n("a",{attrs:{draggable:"false",href:"#"},on:{click:function(t){e.activeTab="library"}}},[e._v(e._s(e.$T("Library")))])]):e._e()]),e._v(" "),"new"===e.activeTab?n("div",{staticClass:"uk-position-absolute theme-category-dropdown"},[n("button",{staticClass:"uk-button uk-button-popover-toggle uk-text-left"},[e._v("\n          "+e._s(e.currentCategoryThemeName)+"\n        ")]),e._v(" "),n("div",{staticStyle:{width:"150px"},attrs:{"uk-popover":"","data-sel-close":"[uk-menu] > li > button"}},[n("ul",{attrs:{"uk-menu":""}},[n("li",[n("button",{class:{"uk-checked":"all"===e.currentCategoryTheme},on:{click:function(t){e.currentCategoryTheme="all"}}},[e._v("\n                "+e._s(e.$T("All"))+"\n              ")])]),e._v(" "),n("li",{staticClass:"uk-menu-divider"}),e._v(" "),e._l(e.categoryThemeOptions,function(t){return n("li",{key:t.category},[n("button",{class:{"uk-checked":e.currentCategoryTheme===t.category},on:{click:function(n){e.currentCategoryTheme=t.category}}},[e._v("\n                "+e._s(t.name)+"\n              ")])])})],2)])]):e._e()])]),e._v(" "),n("div",{staticClass:"uk-window-body uk-flex uk-flex-column uk-child-separator uk-position-relative"},[n("ul",{staticClass:"uk-switcher uk-height-expand uk-flex uk-flex-column main-content-switcher"},[e.availableTabs.includes("new")?n("li",{staticClass:"uk-panel uk-height-expand uk-flex uk-flex-column"},[n("preview-maps",{attrs:{previews:e.ItemsPreviews,"is-show-label":!0},on:{select:function(t){e.selectedThemeId=t},submit:e.createFromSelectedTheme}})],1):e._e(),e._v(" "),e.availableTabs.includes("library")?n("li",{staticClass:"uk-panel uk-height-expand uk-flex uk-flex-column"},[n("preview-maps",{attrs:{previews:e.libraryItemsPreviews,"is-show-label":!1},on:{select:function(t){e.selectedLibraryId=t},submit:e.createFromLibrary}},["cn"!==e.serviceRegion?n("li",{attrs:{slot:"footer"},slot:"footer"},[n("div",{staticClass:"uk-flex uk-flex-column uk-flex-middle"},[n("a",{staticClass:"uk-button uk-button-link uk-button-icon uk-flex uk-flex-middle uk-card uk-card-default uk-card-fix-sized uk-border-rounded uk-flex uk-flex-middle uk-flex-center uk-card-small-shadow",attrs:{draggable:"false",href:"#"},on:{click:function(t){return t.preventDefault(),e.openMoreMaps(t)}}},[n("span",{staticClass:"uk-icon uk-padding-right-xsmall",attrs:{"uk-icon":"icon: external-link"}}),e._v(" "),n("span",{staticClass:"uk-margin-xsmall-left"},[e._v("\n                  "+e._s(e.$T("More Maps"))+"\n                ")])])])]):e._e()])],1):e._e()])]),e._v(" "),n("div",{staticClass:"uk-window-button-bar"},[n("ul",{staticClass:"uk-switcher main-content-switcher"},[n("li",[n("div",{staticClass:"uk-button-group"},[n("button",{staticClass:"uk-button uk-button-primary",attrs:{disabled:!e.selectedThemeId},on:{click:e.createFromSelectedTheme}},[e._v("\n            "+e._s(e.$T("Create"))+"\n          ")]),e._v(" "),n("button",{staticClass:"uk-button uk-button-default",attrs:{type:"button"},on:{click:e.cancel}},[e._v("\n            "+e._s(e.$T("Cancel"))+"\n          ")])])]),e._v(" "),e.availableTabs.includes("library")?n("li",[n("div",{staticClass:"uk-button-group"},[n("button",{staticClass:"uk-button uk-button-primary",attrs:{type:"submit",disabled:!e.selectedLibraryId||e.isDownloading},on:{click:e.createFromLibrary}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isDownloading,expression:"isDownloading"}],attrs:{"uk-spinner":"ratio: 0.4"}}),e._v("\n            "+e._s(e.$T("Open"))+"\n          ")]),e._v(" "),n("button",{staticClass:"uk-button uk-button-default",attrs:{type:"button"},on:{click:e.cancel}},[e._v("\n            "+e._s(e.$T("Cancel"))+"\n          ")])])]):e._e()]),e._v(" "),"new"===e.activeTab?n("div",{staticClass:"uk-button-group"},[n("button",{staticClass:"uk-button uk-button-default",attrs:{type:"button"},on:{click:e.openExistingFile}},[e._v("\n        "+e._s(e.$T("Open File"))+"\n      ")]),e._v(" "),e.isMAS?e._e():n("button",{staticClass:"uk-button uk-button-default",on:{click:e.handleOpenMenu}},[e._v("\n        "+e._s(e.$T("Open Recent"))+"\n      ")])]):e._e()])])},i=[]},23:function(e,t){e.exports=require("events")},25:function(e,t){e.exports=require("os")},26:function(e,t){e.exports=require("crypto")},31:function(e,t){e.exports=require("tty")},32:function(e,t){e.exports=require("net")},4:function(e,t){e.exports=require("path")},49:function(e,t){e.exports=require("url")},6:function(e,t){e.exports=require("electron")},896:function(e,t,n){"use strict";var a=n(107),i=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(12)),o=i(n(2118)),s=i(n(15)),l=n(28),c=n(19),u=n(13),d=i(n(27)),m=n(21),h=i(n(14)),p=a(n(47)),f=n(6),b=i(n(41)),v=n(59),g=n(8),k=i(n(24));function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){(0,r.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const x=(0,d.default)("new"),T=(0,p.load)("static/styles/themes.json"),_={"org.xmind.ui.map.unbalanced":"map-unbalance","org.xmind.ui.map.clockwise":"map-clockwise","org.xmind.ui.logic.right":"logic-right","org.xmind.ui.logic.left":"logic-left","org.xmind.ui.brace.right":"brace-right","org.xmind.ui.brace.left":"brace-left","org.xmind.ui.tree.right":"tree-right","org.xmind.ui.tree.left":"tree-left","org.xmind.ui.org-chart.down":"org-down","org.xmind.ui.org-chart.up":"org-up","org.xmind.ui.fishbone.leftHeaded":"fishbone-left","org.xmind.ui.fishbone.rightHeaded":"fishbone-right","org.xmind.ui.timeline.horizontal":"timeline-horizontal","org.xmind.ui.timeline.vertical":"timeline-vertical","org.xmind.ui.spreadsheet":"matrix-row","org.xmind.ui.spreadsheet.column":"matrix-column"},C={brace:"org.xmind.ui.brace.right",fishbone:"org.xmind.ui.fishbone.leftHeaded",logic:"org.xmind.ui.logic.right",map:"org.xmind.ui.map.unbalanced",matrix:"org.xmind.ui.spreadsheet",org:"org.xmind.ui.org-chart.down",timeline:"org.xmind.ui.timeline.horizontal",tree:"org.xmind.ui.tree.right"},{Menu:$,MenuItem:I}=f.remote;var O={components:{PreviewMaps:o.default},mixins:[b.default],data:()=>({activeTab:"new",callbackEndpoints:null,themeItems:[],selectedThemeId:null,libraryItemsLoaded:!1,selectedLibraryId:null,isDownloading:!1,currentCategoryTheme:"all"}),computed:y({},(0,l.mapState)("cache",["libraryItems"]),{},(0,l.mapGetters)("app",["serviceRegion"]),{availableTabs(){const e="true"===process.env.VANA_LICENSE_MODE&&!process.env.VANA_LICENSE_TO,t="true"===process.env.VANA_LICENSE_MODE&&process.env.VANA_LICENSE_TO,n=this.$store.getters["activation/status"]===g.ACTIVATION_STATUS.VALID,a=this.$store.getters["activation/hasRawPerMachineLicenseDataValidated"];return t||e&&(!n||!a)?["new"]:["new","library"]},touchBarItems(){return["new"===this.activeTab?{type:"button",label:this.$T("Open File"),click:"openExistingFile"}:null,{type:"space",size:"flexible"},{type:"button",label:this.$T("Cancel"),click:"close"},"new"===this.activeTab?{type:"button",label:this.$T("Create"),backgroundColor:"primary",click:"createFromSelectedTheme"}:{type:"button",label:this.$T("Open"),backgroundColor:"primary",click:"createFromLibrary"},{type:"space",size:"flexible"}].filter(Boolean)},activeTabIndex(){return this.availableTabs.indexOf(this.activeTab)},currentCategoryThemeName(){const e=this.currentCategoryTheme,t=this.categoryThemeOptions.find(t=>t.category===e);return t?t.name:this.$T("All")},recentFileItems(){const e=[];for(let{source:t}of this.$store.state.editors.recentlyOpenedItems.slice(0,10)){(0,v.getLocalFileNameFromUri)(t)&&e.push({name:(0,v.getLocalFileNameFromUri)(t),source:t})}return e},libraryItemsPreviews(){return[{label:"Gallery",items:this.libraryItems}]},ItemsPreviews(){return this.categoryThemeOptions.filter(({category:e})=>"all"===this.currentCategoryTheme||this.currentCategoryTheme===e).map(({category:e,name:t})=>({label:t,items:this.themeItems.filter(t=>t.template===e)}))},categoryThemeOptions(){const e=[{category:"map",name:this.$T("Mindmap")},{category:"logic",name:this.$T("Logic Chart")},{category:"brace",name:this.$T("Brace Map")},{category:"org",name:this.$T("Org Chart")},{category:"tree",name:this.$T("Tree Chart")},{category:"timeline",name:this.$T("Timeline")},{category:"fishbone",name:this.$T("Fishbone")},{category:"matrix",name:this.$T("Matrix")}];return this.$store.state.editors.recentlyUsedThemes.length>0&&e.unshift({category:"recent",name:this.$T("Recently Used")}),e},isMAS:()=>!1}),methods:y({},(0,l.mapMutations)({updateLibraryItems:"cache/updateLibraryItems"}),{handleOpenMenu(){const e=new $;for(let t of this.recentFileItems)e.append(new I({label:t.name,click:async()=>{t&&(await this.$store.handleCommand("openRecentFileItem",[t.source]),k.default.existsSync((0,v.urlToFilePath)(t.source))&&window.close())}}));0!==this.recentFileItems.length?(e.append(new I({type:"separator"})),e.append(new I({label:this.$T("Clear Menu"),click:()=>{this.$store.handleCommand("cleanRecent")}}))):e.append(new I({label:this.$T("Clear Menu"),enabled:!1})),e.popup({window:f.remote.getCurrentWindow()})},createFromSelectedTheme(){const e=this.selectedThemeId,t=this.themeItems.find(t=>t.id===e||t.tid===e);if(!t)return!1;const n=t.structureClass||"org.xmind.ui.map.unbalanced",a="recent"===t.template?t.id:t.tid;let i=t.template;"recent"===i&&(Object.entries(C).forEach(([e,n])=>{n===t.structureClass&&(i=e)}),"recent"===i&&(i="default"));const r=`new://workbook?theme=${encodeURIComponent(t.builtInId?t.builtInId:t.id)}`+`&template=${encodeURIComponent(i)}`+`&title=${encodeURIComponent(t.name)}`+`&structure=${encodeURIComponent(n)}`;return window.hide(),this.$store.commit("editors/appendRecentlyUsedTheme",{themeId:a,structureClass:n}),this.$safeRun(()=>Promise.all([h.default.fetch(u.EDITOR_OPEN,{source:r}),(0,m.trackEvent)({eventCategory:"NewPanel",eventAction:"chooseThemeFromNewWindow",eventName:t.name})]).then(()=>{window.close()})).catch(()=>{window.close()}),!1},createFromLibrary(){const e=this.selectedLibraryId;if(e&&!this.isDownloading)return this.isDownloading=!0,h.default.fetch(u.XOS.LIBRARY_DOWNLOAD,{id:e}).then(e=>{this.isDownloading=!1,h.default.fetch(u.EDITOR_OPEN,{source:e}).then(()=>{window.close()})}).catch(t=>{this.isDownloading=!1,x.error("Failed to download workbook from library:",e,(0,c.normalizeError)(t))}),!1},openExistingFile(){this.$store.handleCommand("open"),(0,m.trackEvent)({eventCategory:"NewPanel",eventAction:"openExist"})},openMoreMaps(){h.default.fetch(u.XOS.GO_LIBRARY_MORE_MAPS),(0,m.trackEvent)({eventCategory:"NewPanel",eventAction:"jumpToMore"})},cancel(){window.close()},async refreshLibraryItems(){try{let e=(await h.default.fetch(u.XOS.LIBRARY_ITEMS)).map((e,t)=>{const n=e.thumbnailUrl.replace(/^https/,"cache");return t<6&&h.default.fetch(u.XOS.FILE_DOWNLOAD,{downloadUrl:n,filename:(0,c.HASH)(n)}).catch(()=>{}),{name:"string"==typeof e.topic&&e.topic.trim(),previewURL:n,id:e.id}});this.updateLibraryItems({libraryItems:e})}catch(e){x.error("Failed to get library items:",(0,c.normalizeError)(e))}}}),watch:{serviceRegion(){this.refreshLibraryItems()}},created(){this.refreshLibraryItems();const e=s.default.parse(window.location.search.slice(1));e.tab&&(this.activeTab=e.tab)},mounted(){this.$safeRun(()=>T.then(e=>{const t=(JSON.parse(e).themes||[]).map(e=>({id:e.id,tid:e.tid,name:this.$T("$$",e.name),template:e.template,structureClass:C[e.template],previewURL:this.$toResourceURL(`static/styles/theme_previews/en-US/${encodeURIComponent(e.id)}.svg`)}));this.$set(this,"themeItems",t),this.$watch(()=>[this.$store.state.editors.recentlyUsedThemes,this.$store.state.themeEditor.customThemes],()=>{const e=[];for(let n=this.$store.state.editors.recentlyUsedThemes.length-1;n>=0;n--){const a=this.$store.state.editors.recentlyUsedThemes[n],i=a.themeId,r=a.structureClass,o=_[a.structureClass]||"map-unbalance";let s,l,c,u=t.find(({tid:e})=>e===i);if(u&&(s=u.name,l=this.$toResourceURL(`static/styles/theme_previews/${o}/${o}-${u.id}.svg`),c=u.id),!u){if(!(u=this.$store.state.themeEditor.customThemes.find(({id:e})=>e===i)))continue;s=u.name;const e=u&&u.createdAt;l=p.toURLInAppData(`theme/${i}/previews/${o}.svg?t=${e}`)}e.push({id:i,builtInId:c,name:this.$T("$$",s),template:"recent",structureClass:r,previewURL:l})}this.themeItems=e.concat(t)},{deep:!0,immediate:!0})}))}};t.default=O},897:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}l((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5);t.default=i.createComponent({name:"preview-map",props:{isShowLabel:Boolean,previews:{type:Array,default:()=>[]}},setup(e,t){const n=i.ref(null),r=i.ref(null);return i.onMounted(()=>a(this,void 0,void 0,function*(){yield new Promise(e=>setTimeout(e,0));const e=n.value.querySelector(".uk-card.preview-card");e&&e.click()})),{handleSelectTheme:e=>{r.value=e,t.emit("select",e)},handleSubmitTheme:()=>{t.emit("submit",r.value)},containerElement:n}}})}},[2114]);